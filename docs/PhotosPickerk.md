> Component called Photos Picker which is a new component so let's add this in and just see what this looks like. So the first thing we're going to do is actually go to our screen where we actually allow someone to create a to-do which is here and I'm just going to do that now by going to the view and I have got too many tabs open at the moment let's just close all them. Let's go to modify to do all right boom cool now well I'm not gonna be using the previews because for some reason in Xcode 15 beta 6 the previews are back to what they were before where they're not working so we're stuck with a simulator but what we're going to do is import the photos UI and this framework basically gives us a photo picker for free so we don't need to build our own custom component which is why we're using this. Now there is one thing to note with this, this photos picker doesn't allow you to basically take a picture with the camera as well for free so if you want that you're going to actually add in your own custom solution this just lets you pick a photo that's stored on your device. 

Pierwszą rzeczą, którą zrobimy, jest przejście do ekranu, na którym umożliwiamy komuś utworzenie zadania do zrobienia, co jest tutaj, i właśnie teraz to zrobię, przechodząc do widoku. Mam teraz zbyt wiele otwartych kart, po prostu zamknijmy je wszystkie. Przejdźmy do modyfikacji zadania do wykonania, dobrze, teraz importuję interfejs użytkownika zdjęć, i ten framework daje nam darmowego wybieracza zdjęć, więc nie musimy budować własnego niestandardowego komponentu, dlatego używamy tego. Teraz jest jedna rzecz, którą warto zauważyć, ten wybieracz zdjęć nie pozwala ci bezpłatnie zrobić zdjęcia aparatem, więc jeśli chcesz to zrobić, musisz dodać własne niestandardowe rozwiązanie, ten po prostu pozwala ci wybrać zdjęcie zapisane na twoim urządzeniu.

> So below our section here where you can actually basically select a category so we just go here so here we want to add an option to choose a photo so I'm just going to type this out. So with the photo picker you can see that it takes some parameters here this is only a few of them by the way it's not all of them but the ones we're going to be using is selection which lets us buy into some kind of selection that someone has made we want to specify what someone can select so we're matching any images and we're also going to use the shared photo library as well by default. Now in this closure here we can specify a label that we actually want to show well not a label but a view that we want to show on the screen and in our case we're going to use a label here so when you tap on this it will show our photo picker. Now we don't actually have our selection bound to anything at the moment now so what we need to do is actually create a property well a state property for holding our selection that someone has tapped and also as well a property for basically converting our selection that someone has made into data so we can store that later on. So at the top here below our state properties I'm just going to create two new properties for holding those two you know variables that we need. 

Poniżej naszej sekcji, gdzie możemy wybrać kategorię, chcemy dodać opcję wyboru zdjęcia, więc właśnie to wpiszę. Korzystając z wybieracza zdjęć, zauważysz, że przyjmuje on pewne parametry. To są tylko niektóre z nich, zresztą nie wszystkie, ale te, które będziemy używać, to parametr "selection", który pozwala nam wiedzieć, jakie wybory dokonał użytkownik. Chcemy określić, co użytkownik może wybrać, więc dopasowujemy do jakichkolwiek obrazów, a także domyślnie korzystamy z udostępnionej biblioteki zdjęć. Teraz w tym zamknięciu możemy określić etykietę lub widok, który chcemy wyświetlić na ekranie, a w naszym przypadku będziemy używać tutaj etykiety. Po jej dotknięciu wyświetli się nasz wybieracz zdjęć. Obecnie nasz wybór nie jest jeszcze powiązany z żadnym elementem, więc musimy utworzyć właściwość stanu, która będzie przechowywać nasz wybór po naciśnięciu, oraz właściwość do konwersji naszego wyboru na dane, które będziemy mogli przechować. Więc na samej górze, poniżej naszych właściwości stanu, stworzę dwie nowe właściwości, aby przechowywać te dwie zmienne, których potrzebujemy.

> So with the selected photo this is the photo item that our picker is going to bind to so whatever someone selects is going to be stored in this variable here so this is the type that it uses and then later on what we're going to do is actually listen to the selected photo and then convert that into data which will be stored into here so we can manipulate and work with that. Now down below here in our picker, well not picker down below here in our photos picker you can tell that I've just woken up yeah and I've not had my social gonna body right if you're not from the UK I'll put on a screen here but if you come down to the UK especially Manchester try one and if anyone tells you that it's not called a body they're lying to you anyway so let's replace this with selected photo cool and then now what we need to do is actually listen to changes for this state property now there's two ways of doing this one way of doing it is by using the on change modifier but when you're actually converting a image from a selected photo to data it actually uses an asynchronous function and if you don't know what I mean by that I have it all explained in my Swift concurrency course which I'll put on the screen here but essentially it works with async await so rather than actually using the on change modifier and then putting a task within that what we can actually do instead is use the task modifier and there's a property that allows us to listen to changes that happen on a you know state property now if you scroll all the way down we'll collapse this toolbar 

Więc wybranym zdjęciem będzie obiekt zdjęcia, który będzie powiązany z naszym wybieraczem, więc cokolwiek użytkownik wybierze, będzie przechowywane w tej zmiennej. To jest typ, który jest używany, a później, co zamierzamy zrobić, to nasłuchiwać wybranego zdjęcia, a następnie przekształcić je na dane, które zostaną przechowane tutaj, tak abyśmy mogli manipulować nimi i pracować z nimi. Teraz poniżej, w naszym wybieraczu zdjęć, możesz zauważyć, że właśnie się obudziłem, tak, i jeszcze nie miałem swojej porannej kawy. Jeśli nie jesteś z Wielkiej Brytanii, to dodam na ekranie informację, ale jeśli kiedyś przyjedziesz do Wielkiej Brytanii, zwłaszcza do Manchesteru, spróbuj tego i jeśli ktoś powie ci, że to nie jest nazywane "body", to cię okłamuje. W każdym razie, zastąpmy to wyrażeniem "selected photo", świetnie, a teraz musimy nasłuchiwać zmian w tej właściwości stanu. Istnieją dwa sposoby na to. Jeden sposób to użycie modyfikatora "on change", ale kiedy przekształcasz obraz z wybranego zdjęcia na dane, używa się funkcji asynchronicznej, a jeśli nie wiesz, o co chodzi, mam to wszystko wyjaśnione w moim kursie Swift Concurrency, który pokażę ci na ekranie. W skrócie, działa to za pomocą async await. Zamiast korzystać z modyfikatora "on change" i wstawiać w nim zadanie, możemy użyć modyfikatora "task" i istnieje właściwość, która pozwala nasłuchiwać zmian zachodzących w właściwości stanu. Teraz przewińmy w dół, zwinmy tę belkę narzędziową...

> but if you scroll down to the bottom here I'm going to type here task and you'll see that there's an option here called ID and this allows us to perform an asynchronous function whenever a value changes so we'll use this so in here we'll choose selected photo and we'll just use the closure here like so now when you're working with this API and you're working with selected mode when you're working with the photo picker item there's actually a function on this actual you know API that allows you to convert the photo to data which we'll use now so we're going to say here if let data and because this function can throw we need to use the try keyword but I'm just going to use the optional so if it fails you know this just won't pass we're going to say here selected photo and as a function pause and we're going to say a wait and it's a function here on the selected photo called load transferable type and what this will do is it will actually attempt to basically convert this object into whatever we specify in the type here for the transferable protocol then a type that we want to work with is data so we're going to say here data dot self like so cool all right so now we have our selected photo and it's going to try and load it I'll type data so convert it into a data object for us 



Ale jeśli przewiniesz na sam dół, tutaj wpiszę „task”, i zobaczysz, że jest opcja „ID”, która pozwala nam wykonywać funkcję asynchroniczną za każdym razem, gdy wartość się zmienia. Skorzystamy z tego. Wpiszemy „selected photo” i użyjemy zamknięcia tutaj, tak jak to teraz zrobię. Kiedy pracujesz z tą API i wybierasz tryb „selected” w komponencie wybieracza zdjęć, jest właściwie funkcja na tym API, która pozwala przekształcić zdjęcie na dane, z której teraz skorzystamy. Będziemy mieli coś w rodzaju: „if let data”, ponieważ ta funkcja może zwrócić błąd, musimy użyć słowa kluczowego „try”, ale tutaj użyję opcji opcjonalnej, więc jeśli nie powiedzie się, to po prostu nie przejdzie dalej. Powiemy: „selected photo” i jako funkcję postojową powiemy „await”. Jest funkcja na „selected photo” o nazwie „load transferable type”, która próbuje przekształcić ten obiekt w to, co określimy jako typ w protokole „transferable”. Typem, który chcemy uzyskać, jest „data”, więc powiemy: „data.self” i tak dalej. Teraz mamy nasze wybrane zdjęcie i próbuje je załadować jako dane, konwertując je dla nas w obiekt danych.

> so we want to store this in our selected photo data like so and say data all right boom so now we're able to access this and convert it now what we also want to do is I want to add in a view here that basically gives you a preview to show you that there's an image you know the image that you selected so you can actually see on the screen so above our label here where we're going to have our photo picker we're just going to write some code that unwraps that data property and then sets it to a image in SwiftUI so you can see here I've not done anything too crazy I'm just unwrapping the data creating a UI image and then setting that to the image property in SwiftUI well the image view in SwiftUI and then just applying some styles onto it okay cool so now let's just test this out quickly and when we run this on the simulator you'll now see that if I create a new to-do and you'll see our option here to add an image so the tap on this we got our photo picker and then these are all those default pictures on the simulator but if you had pictures on your phone you can see them obviously I'm not gonna show you my phone yet because I've got too many pictures of me on a night out 



Więc chcemy przechować to w naszym „selected photo data” w ten sposób i powiedzieć „data”, świetnie. Teraz jesteśmy w stanie uzyskać do tego dostęp i przekształcić to. Chcemy także dodać tutaj widok, który po prostu wyświetli podgląd, aby pokazać, że jest obraz, wiesz, obraz, który wybrałeś, tak więc możesz go zobaczyć na ekranie. Powyżej naszej etykiety, gdzie będziemy mieli nasz wybieracz zdjęć, napiszemy kod, który odpakuje tę właściwość danych, a następnie ustawia ją jako obraz w SwiftUI. Jak widzisz, nie robię niczego szalonego. Po prostu odpakowuję dane, tworzę obiekt UI image i ustawiam go jako właściwość obrazu w SwiftUI, a potem dodaję kilka stylów. Ok, świetnie. Teraz po prostu przetestujmy to szybko, a kiedy uruchomimy to na symulatorze, zobaczysz, że jeśli utworzę nowe zadanie do zrobienia, pojawi się opcja dodania obrazu. Po kliknięciu tutaj mamy nasz wybieracz zdjęć, i to są wszystkie te domyślne obrazy na symulatorze, ale jeśli miałbyś obrazy na telefonie, oczywiście mógłbyś je zobaczyć. Nie pokażę ci swojego telefonu, bo mam zbyt wiele zdjęć z nocnych wyjść.

> so I don't think you need to see me with my eyes in two different directions but I've had too many shots so we're gonna leave that one out in it so I'm gonna choose this and now you can see here that we've got our picture of our flowers but the problem that we've got now is that there's actually no way for us actually to you know remove this picture you know we can only add a new picture every time I can't just remove this unless I dismiss and then you know restart it again so to make the UX a bit better we're going to add a button just underneath here where if there is an image will allow someone to remove this image and just reset this so in order to do this it's not crazy it's quite simple all we need to do is basically check to see if our data state property has some kind of value so we're gonna say here if selected photo data is not equal to nil so that means that there's something inside of this variable then we'll add a button here to allow us to remove this image okay cool okay cool so you can see here we've got our button and I've set the role of it to be destructive 



Tak więc nie sądzę, że chcesz mnie widzieć z oczami patrzącymi w dwie różne strony, ale wypiłem zbyt wiele drinków, więc pozostawimy to bez komentarza. Wybiorę to zdjęcie, i teraz możesz zobaczyć, że mamy nasze zdjęcie kwiatów. Ale teraz mamy problem, ponieważ nie ma sposobu, abyśmy mogli to zdjęcie usunąć. Możemy tylko dodać nowe zdjęcie za każdym razem. Nie mogę po prostu usunąć tego zdjęcia, chyba że je odrzucę i zaczynam od nowa. Aby poprawić użyteczność, dodamy przycisk właśnie tutaj, który pozwoli nam usunąć to zdjęcie i zresetować to. Aby to zrobić, nie jest to nic skomplikowanego, jest całkiem proste. W zasadzie musimy sprawdzić, czy nasza właściwość stanu danych ma jakąś wartość. Będziemy mówić tutaj: „jeśli selected photo data nie jest równa nil”, to oznacza, że w tej zmiennej jest coś, wtedy dodamy tutaj przycisk, który pozwoli nam usunąć to zdjęcie. Okej, widzisz, mamy nasz przycisk, a ja ustawiłem jego rolę jako destrukcyjną.

> so the text by default is you know red my my brain isn't working this morning I'm having too many dirt moments but but basically you can see here that within this closure block we've got the wave animation and we're just basically going to reset our state properties back to nil and we're for our label we're just going to show an X mark and some text saying remove image now the reason why I'm using a foreground style of red here is because even though you set the role destructive to red the SF symbol doesn't get set to red as well as only the text now I don't know this is an Xcode beta bug or if this is by intention but I'm just doing this for safety so let's just run this again and then now we're going to new to do and we'll add an image again and now you'll see that we have our remove image button so if I tap on this button to remove the image it removes the image and we basically go back to normal so right now we only actually have the image being stored locally within our crate you know to do view here but what we need to do is actually put this into our model now I said before when you're working with you know when you're working with images you actually want to store them as data and in Swift data one of the data types that you're allowed to have is type data 

Tekst domyślnie jest koloru czerwonego, moje myśli nie działają dobrze tego ranka, mam zbyt wiele momentów zagubienia, ale w zasadzie widzisz tutaj, wewnątrz tego bloku zamknięcia mamy animację fali i po prostu zresetujemy nasze właściwości stanu do nil. Dla naszej etykiety po prostu pokażemy znak X i tekst „Usuń zdjęcie”. Powód, dla którego używam czerwonego stylu pierwszoplanowego, to dlatego, że mimo że ustawiasz rolę jako destrukcyjną na czerwono, symbol SF nie zostaje ustawiony na czerwono, tylko tekst. Nie wiem, czy to jest błąd w wersji beta Xcode, czy celowe działanie, ale robię to dla pewności. Uruchommy to jeszcze raz, teraz stworzymy nowe zadanie do zrobienia i dodamy obraz. Teraz zobaczysz, że mamy przycisk „Usuń zdjęcie”, więc jeśli go naciśnę, zdjęcie zostanie usunięte i wrócimy do stanu normalnego. Obecnie obraz jest przechowywany lokalnie tylko w widoku utworzenia zadania do zrobienia, ale musimy go umieścić w naszym modelu. Powiedziałem wcześniej, że gdy pracujesz z obrazami, chcesz przechowywać je jako dane, a w Swift, jednym z dozwolonych typów danych jest typ „Data”.



so all we need to do is go into our model so if I go into my item here and we'll just go into our model and we're going to have a new property here called image and its type is going to be data now one thing we do want to do is actually make this optional and a reason why we want to make this optional is because if we don't what we're essentially saying is that every single to do must have some kind of image associated with it and we have to create a data instance for every single to do now by making this optional it'll be nil by default and we can set it to something if we want to and something that's really important which we'll look into later in a video is working with data because if you don't work with data properly it's actually possible for your app to grow massively in size and slow down with performance but what we want to do now is back in our create to do view rather than having the state property for a selected photo data we actually want to use the image property we actually want to use the image property that we just created within our model so let's remove the state variable and if we build our project now we should have a whole bunch of errors which is fine what it's sweet but it's not sweet but what we're going to do is replace this with our you know item dot image throughout so here when we have our selected photo they always go say image oh damn that was smart I didn't think it'd do that bloody hell alright okay well that's a cool Xcode feature so we'll replace this with our image data I'm just gonna rename that to image data and then rather than being selected photo data it'll be it'll be item dot image like so and then we'll set our item dot image to nil here as well and then just down below we'll also set it here cool so now we're going to be using our model to basically store this data into our persistent storage let's just run this I see what happens and if we create a new to-do I'm just gonna say here go buy new MacBook okay cool and then I'm just gonna leave the date well we'll just use a random date in the future like the 13th and then we'll say it's important we won't give it a category but on the image we'll just select this flowers actually let's say go buy flowers okay cool and then now we can have a create here or choose done popscroll here's create and now save that so we actually have our to-do here go buy flowers and this is now saved that image into our storage which is what we want but you'll see now that we're actually not able to see our image on the home screen here because we're not actually grabbing it and displaying it which is what we'll look into soon now something else that we'll also be looking into is some UI and UX improvements such as adding in a photo and image viewer as well as how to update our image you know because right now we're only adding our image picker to our create and not to our update screen so we'll see how to update our data well we'll see how to update our image data in Swift Data and we'll also look at some improvements for adding we'll also look at in some improvements for our app to boost its performance and also storage as well which is super important that you don't want to miss so we'll look at that at some point within this video too so make sure you stick around now if you're enjoying this video so far I really appreciate it if you gave it a thumbs up and as well let me know in the comment section below with what other videos you're interested in seeing so right now we don't really show our image onto the screen so what I want to do is just below here where we have our time I want to show like a little preview of that image now in order to do that we're going to need to go to our content view which is our home screen here and where we actually have our H stack we actually want to wrap this within a V stack so that we can stack this and that image below each other so I'm just going to create a V stack like so and then we're just going to cut this and then paste it here now I'm going to collapse the H stack again because what we want to do below this H stack is actually now load the picture below here so what we've done here now is we've just got our item.image so the image from a property we can unwrap that we'll create a UI image and then set that to our image property here and I've just got some styles on it for like the size so the maximum height and just clipping it with a you know with a rounded rectangle so let's just run this and see what happens and now we can see our image that we stored in Swift data just by grabbing it so not a lot of work so far but we're able to now actually save it and also fetch it but something we're not able to do is actually update this image because if I actually swipe across here and go to edit we actually don't have a way to update the image and the nice thing about what it is that you know we've built so far is that I don't actually don't need to do anything different when working with Swift data because when you're updating properties all you need to do is just basically well I should prefix this as long as you have auto save enabled all you need to do is just basically update that model and once you update a property in that model it automatically gets updated and saved for you so we only all we need to do is just literally update our item now in this update view here you'll see that we actually have a property here called bindable property wrapper here which allows us to basically bind our item to this view so any changes we make through this item will automatically be updated and saved within Swift data so we just need to copy our code from our you know create screen into here so what I'm just gonna say here is obviously import photos UI and if I just go to the modify so our create screen we want to take our selected photo here so we'll copy this and then we'll also paste that here where our overstate property is and then I'm just going to lift the entire section that we created before where we basically show the image add the photo pickle and a remove button so we'll collapse this and just copy it and all we need to do is literally just paste this above the section when we have the update button and then finally what we want to do is add in our task modifier so where we have our task modifier here we'll just copy this and then below our on appear we'll paste this like so cool let's just run this and see what happens so with our to do here if I just scroll across and then go to edit you'll see now that we have our photo pickle what I could do is I can remove the image and update and you'll now see that the image goes away we could actually edit it again and this time I can choose a different image so we'll choose a different set of flowers or just choose this well it's not flowers but leaves in it and then we'll choose update and it updates to that image and then finally just show you one more time if I was to choose a different image like this waterfall and then choose update you'll now see how it updates here as well so we've got our crate we've got our read working and we've got our update working as well now one thing that you might have realized here is that it doesn't actually show the full image so it just shows us a little bit of a snippet so what I want to do is actually want to have it where if you tap on this image it opens up a image viewer where I can actually you know interact with it like zooming and all that kind of stuff now for this video I'll be honest with you I don't want to build it from scratch because it'll get super long so what we're going to do instead is actually use a third-party library instead to actually help speed up development and in cases like this this is where I would justify using a third-party library to help you speed up the development of your app now the library that we're going to be using is this library here called SwiftUI image viewer which you can see the github here and the user and we're just going to use Swift package manager to add this to our project so in order to actually add a package in order to actually add a package to your project all you need to do is go to the project here and then when your project is selected go to package dependencies and then hit the plus button and then here you should see on the screen here the URL that's where you want to copy it from a documentation and then now we'll just basically paste that in here and then press enter and then wait for it to download it and now when you type that in you should now see the package here so it's got the installation and obviously how to use it and whatnot so it's a quite a nice and simple package for us to easily add into our project to get this for free so I'm just gonna add this package and we'll add the package here like so and now you should see on package dependencies that the library is in your project so we go to our content view in order to actually use this if we just go to a documentation you'll see here that you need to import SwiftUI image viewer and then we need to add some kind of tap gesture to the image this could be a button as well if you wanted to but we need some kind of action to toggle a state property and then we're going to use a modifier to display the actual you know image on our app and then you can add overlays for buttons and whatnot so let's do this now so in our app here in our main content view we're first of all going to import the library called SwiftUI image viewer like so cool and then we're going to create a new state property within our view for presenting the image viewer so we're just going to have this here called is image viewer presented and by default it will be false now what we want to do is if we scroll down to where our image is if there is an image then we're going to attach a tap gesture to this image so we're just going to say here dot tap gesture perform and then we're now going to say here is image viewer presented is equal to true okay cool all right cool and if you just go back to the documentation you'll see here that you have a full screen cover and you need to pass you need to use the view within this block here so after our tap gesture we're going to say full screen cover is presented is image view presented and then we're going to use the SwiftUI image viewer and then for the image here we're just going to pass in a image like we have done here so we're going to use this here so we're going to copy this put that in here like so cool and then because when this gets presented it doesn't have a close button by default so we're going to use an overlay and then we're going to set the alignment to be top trailing and then the content in here and then we're going to need to build a close button now I'm gonna be a bit lazy I was gonna copy this from the documentation and then just paste that in here change this to is image viewer presented to false and then change the tint from purple to blue like so okay cool sweet so let's just run this and see what happens cool and as you can see now you can see here that we actually have the image and if I tap on it this time we now get an image viewer like so and if we wanted to we can actually like do action I can't run this on my phone yeah but if I wanted to I could actually get pretty much all of this for free which is pretty cool sweet now so far we you might think that we're done but we're actually not done there actually is one small improvement that we can also make as well to our app and that is within our model so let us go into our model right now we're actually saving our images data to the model but a problem is is that we're actually saving the data directly into Swift data storage now there's a few problems with this and the first problem is is that if you have a whole load of images your persistent storage will get pretty big pretty quick because you're storing a whole bunch of data alongside your model now what you want to do instead is actually save your image somewhere else externally and then your data would well your app would actually reference that data from within an external storage to help reduce the size of your application now something you can do it in order to actually easily do that in Swift data is use an attribute and there's actually a property on the attribute to specify that you want this to be externally stored somewhere else now if we say at attribute there's a property here called options and on the options there's something here called external storage and as you can see here it says it stores the properties value as a binary data adjacent to the model storage so that means that this won't be saved directly but in Swift data there'll be a reference to it in Swift data and it will be stored somewhere else so we definitely want to use this so if you're ever working with data make sure that you add this now another preface is in the beta version and there's actually like a warning that this doesn't work properly you know sometimes so by the time the you know proper release comes out this should be all sorted so now if we run this so let's just delete this and then we'll just create a new to-do here called go hiking or something and we'll go and do that next weekend in routine add an image add some hills then we'll create cool and now you can see that we have our category and we have our image and you won't see it now but basically this image is now being stored externally somewhere else and we can interact with it and it's all good sweet so now we saw how to you know save images how to read images how to update images and within Swift they are we've also saw to add a nice library to have speed up our development for adding in a simple you know photo viewer into our app and we've also looked at how to improve the performance of our app by using the attributes property to store data externally so I've hope you heard a I hope you've learned a lot in this video also as well if you want to learn more about Swift data I actually do have this playlist that you can see on the screen here and if you want to learn more about iOS development then check out the courses on my website which you can actually see in the description box below that's everything from me I'll catch you on a bit deuces when you launch your app for the first time you actually may want to give some peeps some preview content You